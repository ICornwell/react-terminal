import{createContext as e,createElement as n,useEffect as t,useContext as o,useState as r,useRef as i,Fragment as l}from"react";import a from"prop-types";import{isMobile as s}from"react-device-detect";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var c=function(){return(c=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function u(e,n,t,o){return new(t||(t=Promise))((function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){e.done?r(e.value):new t((function(n){n(e.value)})).then(l,a)}s((o=o.apply(e,n||[])).next())}))}function d(e,n){var t,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(r=(r=l.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){l.label=i[1];break}if(6===i[0]&&l.label<r[1]){l.label=r[1],r=i;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(i);break}r[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('@import url("https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap");\n#index_terminalContainer__3q4m3 {\n  --control-default-bg-color: #ccc;\n  --control-close-bg-color: #fc5b57;\n  --control-minimize-bg-color: #e5bf3c;\n  --control-maximize-bg-color: #57c038; }\n\n.index_controls__9z-dM {\n  text-align: left;\n  height: 26px;\n  position: relative;\n  top: 4px;\n  margin-left: 4px; }\n  .index_controls__9z-dM .index_consoleCtrl__PQnAL {\n    display: inline-block;\n    width: 13px;\n    height: 13px;\n    margin: 0 3px;\n    border-radius: 50%;\n    background: var(--control-default-bg-color); }\n  .index_controls__9z-dM .index_close__2o6CK {\n    background: var(--control-close-bg-color); }\n  .index_controls__9z-dM .index_minimize__E9mwB {\n    background: var(--control-minimize-bg-color); }\n  .index_controls__9z-dM .index_maximize__sbbYF {\n    background: var(--control-maximize-bg-color); }\n\n.index_editor__2tqRz {\n  text-align: left;\n  height: calc(100% - 46px);\n  padding: 10px 15px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  font-family: "Source Code Pro", monospace;\n  font-size: 18px;\n  line-height: 22px;\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px; }\n  .index_editor__2tqRz .index_mobileInput__jGtyc {\n    position: absolute;\n    top: -2000px;\n    left: -2000px; }\n  .index_editor__2tqRz .index_lineText__2Poex {\n    display: inline;\n    position: relative;\n    top: -1px;\n    margin-left: 8px; }\n  .index_editor__2tqRz .index_preWhiteSpace__3nCT2 {\n    white-space: pre; }\n  .index_editor__2tqRz .index_caret__MYxcn {\n    position: relative;\n    -webkit-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    -moz-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    -o-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    -ms-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    animation: index_blink__RQDX- 0.75s ease-in-out infinite; }\n    .index_editor__2tqRz .index_caret__MYxcn .index_caretAfter__2B8sk {\n      content: "";\n      position: absolute;\n      top: 2px;\n      width: 10px;\n      height: 22px;\n      z-index: 10; }\n\n@-moz-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n\n@-webkit-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n\n@-o-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n\n@keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n  .index_editor__2tqRz a {\n    color: #1a87b5; }\n\n#index_terminalContainer__3q4m3 {\n  height: 100%; }\n\n.index_terminal__1dSq1 {\n  height: 100%;\n  width: 100%;\n  margin: auto;\n  border-radius: 5px; }\n');var p={terminalContainer:"index_terminalContainer__3q4m3",controls:"index_controls__9z-dM",consoleCtrl:"index_consoleCtrl__PQnAL",close:"index_close__2o6CK",minimize:"index_minimize__E9mwB",maximize:"index_maximize__sbbYF",editor:"index_editor__2tqRz",mobileInput:"index_mobileInput__jGtyc",lineText:"index_lineText__2Poex",preWhiteSpace:"index_preWhiteSpace__3nCT2",caret:"index_caret__MYxcn",blink:"index_blink__RQDX-",caretAfter:"index_caretAfter__2B8sk",terminal:"index_terminal__1dSq1"},m=e(null),f=function(e){var t=e.children;return n(m.Provider,{value:p},t)},_={dark:{themeBGColor:"#022833",themeToolbarColor:"#131519",themeColor:"#839496",themePromptColor:"#a917a8"},light:{themeBGColor:"#fdf6e4",themeToolbarColor:"#d8d8d8",themeColor:"#333333",themePromptColor:"#a917a8"},dracula:{themeBGColor:"#272B36",themeToolbarColor:"#DBDBDB",themeColor:"#FFFEFC",themePromptColor:"#a917a8"}},h=e(null),x=function(e){var t=e.children,o=c(c({},_),t.props.themes||{}),r=o[t.props.theme]||o.light;return n(h.Provider,{value:r},t)};function b(e){var t=o(m),r=e.controlButtonLabels,i=e.showControlButtons,l=t?t.consoleCtrl:"",a=i?r.map((function(e){return n("div",{key:e,className:l+" "})})):null;return n("div",{className:t.controls},a)}var v=e(null);function g(e,n,t,o){return u(this,void 0,void 0,(function(){var r,i,l,a,s;return d(this,(function(c){switch(c.label){case 0:return r=o&&!o.isAnswered?function(e,n){var t=e.answers.find((function(e){return e.text.toLowerCase()===n.toLowerCase()}));t&&(e.isAnswered=!0);t&&console.log("Question has been answered!");return t?t.instruction:n}(o,n):n,i=r.trim().split(" "),l=i[0],a=i.slice(1),s=a.join(" "),l&&e[l]?[4,y(e,l,s)]:[3,2];case 1:return[2,c.sent()];case 2:return e.__eval?[4,C(e,r)]:[3,4];case 3:return[2,c.sent()];case 4:return"function"!=typeof t?[3,6]:[4,t(s)];case 5:return[2,c.sent()];case 6:return[2,t]}}))}))}function y(e,n,t){return u(this,void 0,void 0,(function(){var o;return d(this,(function(r){switch(r.label){case 0:return"function"!=typeof(o=e[n])?[3,2]:[4,o(t)];case 1:return[2,r.sent()];case 2:return[2,o]}}))}))}function C(e,n){return u(this,void 0,void 0,(function(){var t;return d(this,(function(o){switch(o.label){case 0:return"function"!=typeof(t=e.__eval)?[3,2]:[4,t(n)];case 1:return[2,o.sent()];case 2:return[2,t]}}))}))}var w=function(e,r,i,a,s,c,p,f){var _=o(v),x=_.bufferedContent,b=_.setBufferedContent,y=o(m),C=o(h);t((function(){if(e){var t;t=a,u(void 0,void 0,void 0,(function(){var e,o,u,m;return d(this,(function(d){switch(d.label){case 0:return"clear"===(t?t.trim().split(" "):[])[0]?(b(""),s(""),r(!1),[2]):(e=n(l,null,x,n("span",{style:{color:C.themePromptColor}},i),n("span",{className:y.lineText+" "+y.preWhiteSpace},a),n("br",null)),b(e),s(""),t?[4,g(c,t,p,f)]:[3,2]);case 1:return u=d.sent(),[3,3];case 2:u="",d.label=3;case 3:return o=u,console.log("output: "+o+", type:"+typeof o),m=function(e,t,o,r,i,a){return n(l,null,t,n("span",{style:{color:o.themePromptColor}},i),n("span",{className:r.lineText+" "+r.preWhiteSpace},a),e?n("span",null,n("br",null),e.split("\n").map((function(e){return n(l,null,e,n("br",null))}))):null)}(o||"",x,C,y,i,a),b(m),r(!1),[2]}}))}))}}),[e])},k=function(e,a,c,u,d,p,f){var _=o(m),x=o(h),b=o(v).appendCommandToHistory,g=i(null),y=r(""),C=y[0],k=y[1],z=r(""),T=z[0],B=z[1],R=r(!1),M=R[0],P=R[1];t((function(){s&&a&&g.current.focus()}),[a]),t((function(){M&&b(C)}),[M]);var D=s&&p?n("div",{className:_.mobileInput},n("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:C,onChange:function(e){return k(e.target.value)},ref:g}),"eh"):null,N=M?n(l,null,D,n("div",{className:_.lineText},a&&e?n("span",{className:_.caret},n("span",{className:_.caretAfter,style:{background:x.themeColor}})):null)):n(l,null,D,n("span",{style:{color:x.themePromptColor}},c),n("div",{className:_.lineText},n("span",{className:_.preWhiteSpace},C),a&&e?n("span",{className:_.caret},n("span",{className:_.caretAfter,style:{background:x.themeColor}})):null,n("span",{className:_.preWhiteSpace},T)));return function(e,n,r,i,l,a,s){var c=o(v),u=c.getPreviousCommand,d=(c.getNextCommand,function(t){if(e&&s){t.preventDefault();var o=t.key;if("Enter"===o)return r(n+i),l(""),void a(!0);var c=null,d=i;"Backspace"===o?c=n.slice(0,-1):"Delete"===o?(c=n,d=i.slice(1)):"ArrowUp"===o?c=u():"ArrowDown"===o?c=n.slice(0,-1):"ArrowLeft"===o?(c=n.slice(0,-1),d=n.slice(-1)+d):"ArrowRight"===o?(c=n+i.slice(0,1),d=i.slice(1)):"End"===o?(c=n+i,d=""):"Home"===o?(c="",d=n+i):c=o&&1===o.length?n+o:n,r(c),l(d),a(!1)}});t((function(){return document.addEventListener("keydown",d),function(){document.removeEventListener("keydown",d)}}))}(a,C,k,T,B,P,p),w(M,P,c,C,k,u,d,f),N};function z(e){var r=i(null),a=i(void 0),s=i(void 0),c=o(m),u=o(h),d=o(v),p=d.bufferedContent,f=d.setBufferedContent;!function(e,n){t((function(){n.current.scrollTop=n.current.scrollHeight}),[e])}(p,r);var _=e.enableInput,x=e.caret,b=e.consoleFocused,y=e.prompt,C=e.commands,w=e.welcomeMessage,z=e.lateResponse,T=e.errorMessage,B=z&&z.id&&z.id!==s.current;B&&(s.current=z.id),B&&z.question&&(a.current=z.question);var R=k(x,b,y,C,T,_,a.current);return console.log("lateResponse: "+z+", id: "+(z?z.id:"err")+", text: "+(z?z.text:"err")),B&&z.text&&f(n(l,null,p,n("span",null,z.text.split("\n").map((function(e){return n(l,null,e,n("br",null))})),z.question?n("span",null,z.question.text,n("ul",null,z.question.answers.map((function(e,t){return n("li",null,n("input",{type:"radio",key:"ans"+t,id:"ans"+t,name:"answer",value:e.instruction,onChange:function(){return g(C,e.text,T,z.question)}}),n("label",{htmlFor:"ans"+t},e.text))})))):null))),n("div",{ref:r,className:c.editor,style:{background:u.themeBGColor}},w,n("br",null),p,R)}function T(e){var l,a,c,u,d=i(null),p=r(!s),f=p[0],_=p[1],x=o(m),v=o(h);l=d,a=f,c=_,u=function(e){l.current&&!l.current.contains(e.target)?c(!1):c(!s||!a)},t((function(){return document.addEventListener("mousedown",u),function(){document.removeEventListener("mousedown",u)}}));var g=e.caret,y=e.theme,C=e.showControlButtons,w=e.controlButtonLabels,k=e.prompt,T=e.commands,B=e.welcomeMessage,R=e.lateResponse,M=e.errorMessage,P=e.enableInput;return console.log("term redraw"),n("div",{ref:d,id:x.terminalContainer,className:x["theme--"+y]},n("div",{className:""+x.terminal,style:{background:v.themeToolbarColor,color:v.themeColor}},n(b,{consoleFocused:f,showControlButtons:C,controlButtonLabels:w}),n(z,{caret:g,consoleFocused:f,prompt:k,commands:T,welcomeMessage:B,lateResponse:R,errorMessage:M,enableInput:P})))}function B(e){var t=e.children;return n(f,null,n(x,null,t))}function R(e){return n(B,null,n(T,c({},e)))}T.propTypes={enableInput:a.bool,caret:a.bool,theme:a.string,showControlButtons:a.bool,controlButtonLabels:a.arrayOf(a.string),prompt:a.string,commands:a.objectOf(a.oneOfType([a.string,a.func,a.node])),welcomeMessage:a.oneOfType([a.string,a.func,a.node]),errorMessage:a.string},T.defaultProps={enableInput:!0,caret:!0,theme:"light",showControlButtons:!0,controlButtonLabels:["close","minimize","maximize"],prompt:">>>",commands:{},welcomeMessage:"",errorMessage:"not found!"};var M=function(e){var o=e.children,i=r(""),l=i[0],a=i[1],s=r([]),c=s[0],u=s[1],d=r(null),p=d[0],m=d[1];t((function(){m(c.length)}),[c]);return n(v.Provider,{value:{bufferedContent:l,setBufferedContent:a,appendCommandToHistory:function(e){e&&u(c.concat(e))},getPreviousCommand:function(){if(0===p)return 0===c.length?"":c[0];var e=c[p-1];return p>0&&m(p-1),e},getNextCommand:function(){if(p+1<=c.length){if(p===c.length)return"";var e=c[p+1];return m(p+1),e}return""}}},o)},P={ReactTerminal:R,TerminalContextProvider:M};export default P;export{R as ReactTerminal,M as TerminalContextProvider};
